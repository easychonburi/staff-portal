<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Easy Time Attendance</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        /* --- RESET & BASIC SETUP --- */
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Kanit', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: #FFF9F0; color: #333; min-height: 100vh; overflow-x: hidden; }
        .hidden { display: none !important; }
        .flex-center { display: flex; justify-content: center; align-items: center; }
        .flex-col { display: flex; flex-direction: column; }

        /* --- LOGIN PAGE --- */
        #login-section { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #ED1C24; z-index: 100; padding: 2rem; text-align: center; transition: opacity 0.5s; }
        .login-brand { margin-top: 15vh; margin-bottom: 2rem; }
        .brand-text-main { font-size: 3rem; font-weight: 800; color: #FFDE17; line-height: 1; }
        .login-instruction { color: white; font-size: 1.5rem; font-weight: 600; margin-bottom: 2rem; line-height: 1.4; }
        .pin-container { display: flex; justify-content: center; gap: 15px; margin-bottom: 3rem; }
        .pin-input { width: 60px; height: 60px; background-color: #FFF9F0; border: none; border-radius: 12px; text-align: center; font-size: 2rem; font-weight: bold; color: #333; outline: none; }
        .pin-input:focus { box-shadow: 0 0 0 4px rgba(255, 222, 23, 0.5); }
        .btn-login { background-color: #FFDE17; color: #000; font-size: 1.5rem; font-weight: 800; padding: 12px 40px; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.2); transition: transform 0.1s; }
        .btn-login:active { transform: scale(0.95); }
        .btn-login:disabled { background-color: #ccc; cursor: not-allowed; }

        /* --- DASHBOARD --- */
        #dashboard-section { padding-bottom: 40px; }
        .dashboard-header { background-color: #ED1C24; border-bottom-left-radius: 40px; border-bottom-right-radius: 40px; padding: 20px 20px 30px 20px; color: white; display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .header-left h1 { color: #FFDE17; font-size: 1.8rem; font-weight: 800; line-height: 1; margin-bottom: 5px; }
        .header-left h2 { font-size: 1.4rem; font-weight: 500; }
        .container { padding: 0 20px; max-width: 500px; margin: 0 auto; }
        .card { background: white; border: 2px solid #000; border-radius: 20px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 0 rgba(0,0,0,0.1); }
        
        /* Location Status */
        .location-grid { display: flex; align-items: center; gap: 15px; }
        .status-dot { width: 50px; height: 50px; background: #ccc; border-radius: 50%; flex-shrink: 0; transition: background 0.3s; }
        .status-dot.active { background: linear-gradient(135deg, #2ecc71, #27ae60); box-shadow: 0 0 10px #2ecc71; }
        .status-dot.error { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .location-info h3 { font-size: 1.2rem; margin-bottom: 5px; }
        .location-info p { font-size: 0.9rem; color: #555; margin-bottom: 2px; }
        .text-status { font-weight: 600; font-size: 0.9rem; }
        .text-green { color: #27ae60; }
        .text-red { color: #c0392b; }

        /* Clock */
        .clock-card { text-align: center; }
        .clock-title { font-size: 1.2rem; font-weight: 600; margin-bottom: 5px; }
        .digital-clock { font-size: 3rem; font-weight: 800; line-height: 1; font-variant-numeric: tabular-nums; letter-spacing: 2px; }

        /* Buttons */
        .action-row { display: flex; gap: 15px; margin-bottom: 25px; }
        .action-btn { flex: 1; border: none; border-radius: 20px; padding: 25px 10px; color: white; cursor: pointer; text-align: center; transition: all 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.15); opacity: 0.5; pointer-events: none; } /* Disabled by default */
        .action-btn.ready { opacity: 1; pointer-events: auto; }
        .action-btn:active { transform: scale(0.96); }
        .btn-checkin { background-color: #009245; }
        .btn-checkout { background-color: #ED1C24; }
        .action-btn small { display: block; font-size: 1rem; opacity: 0.9; }
        .action-btn span { display: block; font-size: 1.8rem; font-weight: 800; }

        /* Loader */
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #ED1C24; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <section id="login-section" class="flex-center flex-col">
        <div class="login-brand">
            <div class="brand-text-main">EASY</div>
        </div>
        <div class="login-instruction">
            ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô<br>4 ‡∏´‡∏•‡∏±‡∏Å (PIN)
        </div>
        <div class="pin-container">
            <input type="tel" maxlength="1" class="pin-input" id="pin-1" data-index="1">
            <input type="tel" maxlength="1" class="pin-input" id="pin-2" data-index="2">
            <input type="tel" maxlength="1" class="pin-input" id="pin-3" data-index="3">
            <input type="tel" maxlength="1" class="pin-input" id="pin-4" data-index="4">
        </div>
        <button class="btn-login" id="btnLoginBtn" onclick="handleLogin()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
        <p id="loginStatus" style="color:white; margin-top:15px; font-weight:300; min-height:24px;"></p>
    </section>

    <section id="dashboard-section" class="hidden">
        <div class="dashboard-header">
            <div class="header-left">
                <h1>EASY</h1>
                <h2 id="userNameDisplay">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ...</h2>
                <small id="userBranchDisplay" style="color:#FFDE17;">‡∏£‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</small>
            </div>
            <div class="menu-icon" onclick="location.reload()">‚Üª</div>
        </div>

        <div class="container">
            <div class="card location-card">
                <div class="location-grid">
                    <div id="statusDot" class="status-dot"></div>
                    <div class="location-info">
                        <h3>‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h3>
                        <p id="locationName">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...</p>
                        <p id="distanceText">‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</p>
                        <p id="statusText" class="text-status" style="color:#999;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö GPS...</p>
                    </div>
                </div>
            </div>

            <div class="card clock-card">
                <div class="clock-title">‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
                <div class="digital-clock" id="live-clock">00:00:00</div>
            </div>

            <div class="action-row">
                <button id="btnIn" class="action-btn btn-checkin" onclick="recordAction('‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô (Clock In)')">
                    <small>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</small>
                    <span>‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô</span>
                </button>
                <button id="btnOut" class="action-btn btn-checkout" onclick="recordAction('‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô (Clock Out)')">
                    <small>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</small>
                    <span>‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô</span>
                </button>
            </div>
        </div>
    </section>

   <script>
        // üî¥üî¥ URL ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ß‡∏¥‡∏ß (‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Login ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤) üî¥üî¥
        const API_URL = "https://script.google.com/macros/s/AKfycbxqUGKChxYDIFPQj4XCf_KXrWz80eVqtGoj_U5tfbSY736DXIH8mlqaOH-k0ooACUYi/exec";

        var currentUser = {};
        var currentLocation = { lat: 0, lng: 0, name: "Unknown" };
        var isLocationReady = false;

        // ‚úÖ‚úÖ ‡πÄ‡∏à‡∏°‡∏°‡∏µ‡πà‡∏ù‡∏±‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏¢ (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å Google ‡πÅ‡∏•‡πâ‡∏ß) ‚úÖ‚úÖ
        var shopLocations = [
            {"name":"‡∏≠‡∏°‡∏ï‡∏∞‡∏ô‡∏Ñ‡∏£", "lat":13.4429015, "lng":101.0299502},
            {"name":"‡∏û‡∏£‡∏∞‡∏¢‡∏≤‡∏™‡∏±‡∏à‡∏à‡∏≤", "lat":13.3478668, "lng":100.971527},
            {"name":"‡∏ö‡∏≤‡∏á‡πÅ‡∏™‡∏ô", "lat":13.2806205, "lng":100.9330387},
            {"name":"‡∏≠‡πà‡∏≤‡∏ß‡∏≠‡∏∏‡∏î‡∏°", "lat":13.1144392, "lng":100.9249934},
            {"name":"‡∏´‡∏ô‡∏≠‡∏á‡∏ï‡∏≥‡∏•‡∏∂‡∏á", "lat":13.41045, "lng":101.055621},
            {"name":"‡∏ß‡∏±‡∏á‡∏´‡∏¥‡∏ô", "lat":13.830245, "lng":100.588357}
        ];

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö
        window.onload = function() {
            updateClock();
            setInterval(updateClock, 1000);
            
            // ‡∏™‡∏±‡πà‡∏á‡πÄ‡∏õ‡∏¥‡∏î GPS ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
            watchLocation();
            
            // ‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏•‡∏¢‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏£‡πâ‡∏≠‡∏° (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏£‡∏≤‡∏ù‡∏±‡∏á‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß)
            document.getElementById('userBranchDisplay').innerText = "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏Ç‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô";
            
            document.getElementById('pin-1').focus();
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô PIN input
        const pinInputs = document.querySelectorAll('.pin-input');
        pinInputs.forEach((input, index) => {
            input.addEventListener('input', (e) => {
                if (e.target.value.length === 1) {
                    const nextInput = document.querySelector(`#pin-${index + 2}`);
                    if (nextInput) nextInput.focus();
                }
            });
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace' && e.target.value === '') {
                    const prevInput = document.querySelector(`#pin-${index}`);
                    if (prevInput) prevInput.focus();
                }
            });
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Login (‡∏¢‡∏±‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏ñ‡∏≤‡∏° Google ‡∏≠‡∏¢‡∏π‡πà)
        function handleLogin() {
            let pin = '';
            pinInputs.forEach(input => pin += input.value);

            if (pin.length !== 4) {
                document.getElementById('loginStatus').innerText = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 4 ‡∏´‡∏•‡∏±‡∏Å";
                return;
            }

            const btn = document.getElementById('btnLoginBtn');
            const status = document.getElementById('loginStatus');
            btn.disabled = true;
            btn.innerHTML = '<div class="loader"></div>';
            status.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";

            // ‡∏¢‡∏¥‡∏á‡πÑ‡∏õ‡∏ñ‡∏≤‡∏° Google
            fetch(API_URL + "?action=verifyPin&pin=" + pin)
            .then(res => res.json())
            .then(result => {
                if (result.success) {
                    currentUser = result;
                    enterDashboard();
                } else {
                    btn.disabled = false;
                    btn.innerText = "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö";
                    status.innerText = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
                    pinInputs.forEach(input => input.value = '');
                    document.getElementById('pin-1').focus();
                }
            })
            .catch(err => {
                // ‡∏Å‡∏£‡∏ì‡∏µ‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô: ‡∏ñ‡πâ‡∏≤ Login ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ URL
                btn.disabled = false;
                btn.innerText = "‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á";
                status.innerText = "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ";
                console.error(err);
            });
        }

        function enterDashboard() {
            document.getElementById('userNameDisplay').innerText = "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ ‡∏Ñ‡∏∏‡∏ì" + currentUser.name;
            document.getElementById('userBranchDisplay').innerText = "‡∏™‡∏≤‡∏Ç‡∏≤: " + currentUser.branch;
            const loginSec = document.getElementById('login-section');
            loginSec.style.opacity = '0';
            setTimeout(() => {
                loginSec.classList.add('hidden');
                document.getElementById('dashboard-section').classList.remove('hidden');
                
                // ‡∏û‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤ Dashboard ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                if(currentLocation.lat !== 0) {
                     updatePosition({coords: {latitude: currentLocation.lat, longitude: currentLocation.lng}});
                }
            }, 500);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô GPS
        function watchLocation() {
            document.getElementById('statusText').innerText = "üì° ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì GPS...";
            if (navigator.geolocation) {
                navigator.geolocation.watchPosition(updatePosition, showGpsError, {
                    enableHighAccuracy: true,
                    timeout: 20000,
                    maximumAge: 0
                });
            } else {
                showGpsError({ message: "Browser ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö GPS" });
            }
        }

        function updatePosition(position) {
            var lat = position.coords.latitude;
            var lng = position.coords.longitude;
            currentLocation.lat = lat;
            currentLocation.lng = lng;

            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏´‡∏≤‡∏£‡πâ‡∏≤‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡∏™‡∏∏‡∏î (‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ó‡∏µ‡πà‡∏ù‡∏±‡∏á‡πÑ‡∏ß‡πâ)
            var nearest = null;
            var minDist = 9999999; 
            for(var i=0; i<shopLocations.length; i++) {
                var d = getDistanceFromLatLonInKm(lat, lng, shopLocations[i].lat, shopLocations[i].lng);
                if(d < minDist) { minDist = d; nearest = shopLocations[i]; }
            }

            const dot = document.getElementById('statusDot');
            const locName = document.getElementById('locationName');
            const distText = document.getElementById('distanceText');
            const statusText = document.getElementById('statusText');
            const btnIn = document.getElementById('btnIn');
            const btnOut = document.getElementById('btnOut');
            const ALLOWED_RADIUS = 0.5; // ‡∏£‡∏±‡∏®‡∏°‡∏µ 500 ‡πÄ‡∏°‡∏ï‡∏£

            if (nearest) {
                var distMeters = Math.round(minDist * 1000);
                locName.innerText = "‡πÉ‡∏Å‡∏•‡πâ: " + nearest.name;
                distText.innerText = "‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á: " + distMeters + " ‡πÄ‡∏°‡∏ï‡∏£";
                currentLocation.name = nearest.name;

                if (minDist <= ALLOWED_RADIUS) {
                    dot.className = "status-dot active";
                    statusText.innerText = "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‚úÖ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÑ‡∏î‡πâ";
                    statusText.className = "text-status text-green";
                    btnIn.classList.add('ready');
                    btnOut.classList.add('ready');
                    isLocationReady = true;
                } else {
                    dot.className = "status-dot error";
                    statusText.innerText = "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‚ùå ‡πÑ‡∏Å‡∏•‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ";
                    statusText.className = "text-status text-red";
                    btnIn.classList.remove('ready');
                    btnOut.classList.remove('ready');
                    isLocationReady = false;
                }
            }
        }

        function showGpsError(error) {
            document.getElementById('statusText').innerText = "‚ö†Ô∏è ‡∏à‡∏±‡∏ö‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ";
            document.getElementById('statusText').className = "text-status text-red";
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤
        function recordAction(actionType) {
            if (!isLocationReady) { alert("‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà"); return; }
            if(!confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£ " + actionType + " ?")) return;
            
            const btnIn = document.getElementById('btnIn');
            const btnOut = document.getElementById('btnOut');
            btnIn.classList.remove('ready');
            btnOut.classList.remove('ready');
            document.getElementById('statusText').innerText = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";

            var data = {
                name: currentUser.name,
                action: actionType,
                location: currentLocation.name,
                lat: currentLocation.lat,
                lng: currentLocation.lng
            };

            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ Google (‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ fetch)
            fetch(API_URL, {
                method: "POST",
                body: JSON.stringify(data)
            })
            .then(res => res.json())
            .then(result => {
                alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! üéâ");
                location.reload(); 
            })
            .catch(err => {
                // ‡∏ö‡∏≤‡∏á‡∏ó‡∏µ Google ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÅ‡∏ï‡πà Browser ‡∏ö‡∏•‡πá‡∏≠‡∏Å CORS 
                // ‡πÅ‡∏ï‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏•‡∏á Sheet ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡πÜ
                alert("‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß! (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á)");
                location.reload(); 
            });
        }

        function updateClock() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            document.getElementById('live-clock').textContent = timeStr;
        }
        function getDistanceFromLatLonInKm(lat1,lon1,lat2,lon2) {
            var R = 6371; var dLat = deg2rad(lat2-lat1); var dLon = deg2rad(lon2-lon1); 
            var a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * Math.sin(dLon/2) * Math.sin(dLon/2); 
            var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); return R * d;
        }
        function deg2rad(deg) { return deg * (Math.PI/180); }
    </script>
</body>

</html>

